# ğŸ¤ "çŸ¥é”™å°±æ”¹" æŠ€æœ¯å®ç°ç‰ˆæ±‡æŠ¥ç¨¿

## ğŸ“‹ æ±‡æŠ¥å¤§çº²ï¼ˆ15-20åˆ†é’Ÿï¼‰

```
1. é¡¹ç›®æ¦‚è¿°                    (1åˆ†é’Ÿ)
2. æŠ€æœ¯æ¶æ„è®¾è®¡                (3åˆ†é’Ÿ) â­ é‡ç‚¹
3. æ ¸å¿ƒæŠ€æœ¯å®ç°                (8åˆ†é’Ÿ) â­â­ æ ¸å¿ƒ
   - AIå›¾åƒè¯†åˆ«å®ç°
   - æ™ºèƒ½è§£æå¼•æ“
   - çŸ¥è¯†å›¾è°±æ„å»º
   - æ¨èç®—æ³•
4. å…³é”®æŠ€æœ¯éš¾ç‚¹ä¸è§£å†³æ–¹æ¡ˆ      (4åˆ†é’Ÿ) â­ é‡ç‚¹
5. æ€§èƒ½ä¼˜åŒ–ä¸å¹¶å‘å¤„ç†          (2åˆ†é’Ÿ)
6. æ€»ç»“ä¸å±•æœ›                  (2åˆ†é’Ÿ)
```

---

## ç¬¬ä¸€éƒ¨åˆ†ï¼šé¡¹ç›®æ¦‚è¿°ï¼ˆ1åˆ†é’Ÿï¼‰

å„ä½è€å¸ˆå¥½ï¼Œæˆ‘ä»Šå¤©æ±‡æŠ¥çš„é¡¹ç›®æ˜¯"çŸ¥é”™å°±æ”¹"æ™ºèƒ½é”™é¢˜ç®¡ç†ç³»ç»Ÿã€‚

**æ ¸å¿ƒæŠ€æœ¯ç‰¹ç‚¹ï¼š**
- å‰åç«¯åˆ†ç¦»çš„å¾®æœåŠ¡æ¶æ„
- AIå¤§æ¨¡å‹æ·±åº¦é›†æˆ
- å®æ—¶æ¨èç®—æ³•
- é«˜å¹¶å‘æ•°æ®å¤„ç†

æ¥ä¸‹æ¥æˆ‘å°†ä»æŠ€æœ¯æ¶æ„ã€æ ¸å¿ƒå®ç°ã€æŠ€æœ¯éš¾ç‚¹ä¸‰ä¸ªæ–¹é¢è¿›è¡Œè¯¦ç»†æ±‡æŠ¥ã€‚

---

## ç¬¬äºŒéƒ¨åˆ†ï¼šæŠ€æœ¯æ¶æ„è®¾è®¡ï¼ˆ3åˆ†é’Ÿï¼‰â­

### 1. æ•´ä½“æ¶æ„ï¼ˆåˆ†å±‚è®¾è®¡ï¼‰

**ã€å±•ç¤ºæ¶æ„å›¾ã€‘**

æˆ‘ä»¬é‡‡ç”¨ç»å…¸çš„**å››å±‚æ¶æ„**è®¾è®¡ï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         å‰ç«¯å±•ç¤ºå±‚ï¼ˆPresentationï¼‰        â”‚
â”‚   Vue 3 + TypeScript + Vite + Pinia     â”‚
â”‚   ç»„ä»¶åŒ–å¼€å‘ + å“åº”å¼è®¾è®¡                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â†“ HTTP/HTTPS + RESTful API
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         ä¸šåŠ¡é€»è¾‘å±‚ï¼ˆBusiness Logicï¼‰      â”‚
â”‚         Spring Boot 3.3.2               â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚ é”™é¢˜ç®¡ç† â”‚ ç­çº§ç®¡ç† â”‚ ç»Ÿè®¡åˆ†æ â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚   â”‚  Spring Security + JWT       â”‚     â”‚
â”‚   â”‚  æƒé™æ§åˆ¶ RBAC               â”‚     â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         AIæœåŠ¡å±‚ï¼ˆAI Serviceï¼‰           â”‚
â”‚   æ™ºè°±GLM-4V (å›¾åƒè¯†åˆ«)                  â”‚
â”‚   æ™ºè°±GLM-4 (NLPå¤„ç†)                    â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚ å›¾åƒè¯†åˆ« â”‚ æ™ºèƒ½åˆ†æ â”‚ çŸ¥è¯†å›¾è°± â”‚   â”‚
â”‚   â”‚ çŸ¥è¯†æå– â”‚ æ¨èç®—æ³• â”‚ NLPè§£æ  â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         æ•°æ®æŒä¹…å±‚ï¼ˆData Layerï¼‰         â”‚
â”‚         MySQL 8.0 + JPA                 â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚  ç”¨æˆ·è¡¨  â”‚  é¢˜åº“è¡¨  â”‚  ç»Ÿè®¡è¡¨  â”‚   â”‚
â”‚   â”‚  ç­çº§è¡¨  â”‚  çŸ¥è¯†ç‚¹  â”‚  æ—¥å¿—è¡¨  â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**æ¶æ„ç‰¹ç‚¹ï¼š**

1. **å‰åç«¯åˆ†ç¦»**
   - å‰ç«¯ç‹¬ç«‹éƒ¨ç½²ï¼Œé€šè¿‡RESTful APIé€šä¿¡
   - è§£è€¦åˆï¼Œä¾¿äºç»´æŠ¤å’Œæ‰©å±•

2. **å¾®æœåŠ¡åŒ–æ€æƒ³**
   - AIæœåŠ¡ç‹¬ç«‹å°è£…ï¼Œå¯å•ç‹¬å‡çº§
   - ä¸šåŠ¡æ¨¡å—åŒ–ï¼Œé™ä½è€¦åˆåº¦

3. **å®‰å…¨æ€§è®¾è®¡**
   - JWTæ— çŠ¶æ€è®¤è¯
   - RBACæƒé™æ§åˆ¶ï¼ˆå­¦ç”Ÿ/æ•™å¸ˆ/ç®¡ç†å‘˜ï¼‰
   - æ•°æ®ä¼ è¾“HTTPSåŠ å¯†

---

### 2. æŠ€æœ¯é€‰å‹ï¼ˆä¸ºä»€ä¹ˆé€‰è¿™äº›æŠ€æœ¯ï¼‰

**ã€æŠ€æœ¯æ ˆå¯¹æ¯”è¡¨ã€‘**

| å±‚çº§ | æŠ€æœ¯é€‰å‹ | é€‰æ‹©ç†ç”± |
|------|---------|---------|
| **å‰ç«¯æ¡†æ¶** | Vue 3 (Composition API) | â‘  æ¸è¿›å¼æ¡†æ¶ï¼Œçµæ´»æ˜“ç”¨<br>â‘¡ ç»„ä»¶åŒ–å¼€å‘ï¼Œä»£ç å¤ç”¨æ€§å¼º<br>â‘¢ ç”Ÿæ€æˆç†Ÿï¼Œç¤¾åŒºæ´»è·ƒ |
| **ç±»å‹ç³»ç»Ÿ** | TypeScript | â‘  é™æ€ç±»å‹æ£€æŸ¥ï¼Œå‡å°‘è¿è¡Œæ—¶é”™è¯¯<br>â‘¡ IDEæ”¯æŒå¥½ï¼Œå¼€å‘æ•ˆç‡é«˜<br>â‘¢ ä¼ä¸šçº§é¡¹ç›®æ ‡é… |
| **æ„å»ºå·¥å…·** | Vite 5 | â‘  å†·å¯åŠ¨å¿«ï¼ˆESMï¼‰<br>â‘¡ HMRçƒ­æ›´æ–°é€Ÿåº¦å¿«<br>â‘¢ å¼€ç®±å³ç”¨ |
| **UIæ¡†æ¶** | Element Plus 2.8 | â‘  ç»„ä»¶ä¸°å¯Œï¼Œå¼€ç®±å³ç”¨<br>â‘¡ è®¾è®¡è§„èŒƒç»Ÿä¸€<br>â‘¢ æ–‡æ¡£å®Œå–„ |
| **åç«¯æ¡†æ¶** | Spring Boot 3.3.2 | â‘  ä¼ä¸šçº§æ¡†æ¶ï¼Œæˆç†Ÿç¨³å®š<br>â‘¡ è‡ªåŠ¨é…ç½®ï¼Œå¼€å‘æ•ˆç‡é«˜<br>â‘¢ ç”Ÿæ€å®Œå–„ |
| **å®‰å…¨æ¡†æ¶** | Spring Security + JWT | â‘  å®‰å…¨æ€§å¼º<br>â‘¡ æ— çŠ¶æ€è®¤è¯ï¼Œé€‚åˆåˆ†å¸ƒå¼<br>â‘¢ é›†æˆæ–¹ä¾¿ |
| **ORM** | Spring Data JPA | â‘  ç®€åŒ–æ•°æ®åº“æ“ä½œ<br>â‘¡ è‡ªåŠ¨ç”ŸæˆSQL<br>â‘¢ æ”¯æŒå¤æ‚æŸ¥è¯¢ |
| **æ•°æ®åº“** | MySQL 8.0 | â‘  å¼€æºå…è´¹<br>â‘¡ æ€§èƒ½å¥½ï¼Œç¨³å®š<br>â‘¢ ç¤¾åŒºæ”¯æŒå¼º |
| **AIæœåŠ¡** | æ™ºè°±GLM-4V/4 | â‘  å›½å†…é¡¶å°–å¤§æ¨¡å‹<br>â‘¡ å¤šæ¨¡æ€èƒ½åŠ›å¼º<br>â‘¢ ä¸­æ–‡ç†è§£å¥½ |

---

## ç¬¬ä¸‰éƒ¨åˆ†ï¼šæ ¸å¿ƒæŠ€æœ¯å®ç°ï¼ˆ8åˆ†é’Ÿï¼‰â­â­

### 1. AIå›¾åƒè¯†åˆ«å®ç°ï¼ˆ2åˆ†é’Ÿï¼‰

**æŠ€æœ¯æ ˆï¼š** æ™ºè°±GLM-4V + å›¾åƒé¢„å¤„ç†

**å®ç°æµç¨‹ï¼š**

```java
// æ ¸å¿ƒä»£ç ï¼šGLMService.java

@Service
public class GLMService {
    
    /**
     * å›¾åƒè¯†åˆ« - ä½¿ç”¨GLM-4Vå¤šæ¨¡æ€å¤§æ¨¡å‹
     */
    public String recognizeImage(MultipartFile imageFile) throws IOException {
        // ç¬¬1æ­¥ï¼šå›¾åƒé¢„å¤„ç†
        byte[] imageBytes = preprocessImage(imageFile);
        String base64Image = Base64.getEncoder().encodeToString(imageBytes);
        
        // ç¬¬2æ­¥ï¼šæ„å»ºè¯·æ±‚ä½“ï¼ˆå¤šæ¨¡æ€è¾“å…¥ï¼‰
        JSONObject requestBody = new JSONObject();
        requestBody.put("model", "glm-4v-flash");  // è§†è§‰æ¨¡å‹
        
        JSONArray messages = new JSONArray();
        JSONObject message = new JSONObject();
        message.put("role", "user");
        
        // å¤šæ¨¡æ€å†…å®¹ï¼šæ–‡æœ¬ + å›¾åƒ
        JSONArray content = new JSONArray();
        
        // æ–‡æœ¬Prompt
        JSONObject textContent = new JSONObject();
        textContent.put("type", "text");
        textContent.put("text", 
            "è¯·è¯†åˆ«å›¾ç‰‡ä¸­çš„é¢˜ç›®å†…å®¹ã€‚è¦æ±‚ï¼š\n" +
            "1. å®Œæ•´è¯†åˆ«æ‰€æœ‰æ–‡å­—ï¼ŒåŒ…æ‹¬é¢˜å¹²ã€é€‰é¡¹\n" +
            "2. è¯†åˆ«æ•°å­¦å…¬å¼ï¼Œç”¨LaTeXæ ¼å¼è¡¨ç¤º\n" +
            "3. ä¿æŒåŸæ–‡æ ¼å¼å’Œæ¢è¡Œ\n" +
            "4. åªè¿”å›è¯†åˆ«ç»“æœï¼Œä¸è¦å…¶ä»–è¯´æ˜"
        );
        content.add(textContent);
        
        // å›¾åƒå†…å®¹
        JSONObject imageContent = new JSONObject();
        imageContent.put("type", "image_url");
        JSONObject imageUrl = new JSONObject();
        imageUrl.put("url", "data:image/jpeg;base64," + base64Image);
        imageContent.put("image_url", imageUrl);
        content.add(imageContent);
        
        message.put("content", content);
        messages.add(message);
        requestBody.put("messages", messages);
        
        // ç¬¬3æ­¥ï¼šè°ƒç”¨GLM API
        String response = callGLMAPI(requestBody);
        
        // ç¬¬4æ­¥ï¼šè§£æè¿”å›ç»“æœ
        JSONObject result = JSON.parseObject(response);
        String recognizedText = result.getJSONArray("choices")
            .getJSONObject(0)
            .getJSONObject("message")
            .getString("content");
        
        return recognizedText;
    }
    
    /**
     * å›¾åƒé¢„å¤„ç† - æå‡è¯†åˆ«å‡†ç¡®ç‡
     */
    private byte[] preprocessImage(MultipartFile file) throws IOException {
        BufferedImage image = ImageIO.read(file.getInputStream());
        
        // 1. å»å™ªå¤„ç†
        // 2. å¯¹æ¯”åº¦å¢å¼º
        // 3. äºŒå€¼åŒ–ï¼ˆå¦‚æœéœ€è¦ï¼‰
        // 4. çŸ«æ­£å€¾æ–œ
        
        ByteArrayOutputStream baos = new ByteArrayOutputStream();
        ImageIO.write(image, "jpg", baos);
        return baos.toByteArray();
    }
}
```

**å…³é”®æŠ€æœ¯ç‚¹ï¼š**

1. **å¤šæ¨¡æ€è¾“å…¥è®¾è®¡**
   - åŒæ—¶ä¼ å…¥æ–‡æœ¬Promptå’Œå›¾åƒ
   - æ–‡æœ¬Promptå¼•å¯¼AIå¦‚ä½•è¯†åˆ«

2. **Prompt Engineering**
   - æ˜ç¡®è¦æ±‚ï¼šå®Œæ•´ã€å…¬å¼ã€æ ¼å¼
   - æå‡è¯†åˆ«å‡†ç¡®ç‡

3. **å›¾åƒé¢„å¤„ç†**
   - æå‡å›¾åƒè´¨é‡
   - æé«˜è¯†åˆ«å‡†ç¡®ç‡

**æ€§èƒ½æŒ‡æ ‡ï¼š**
- è¯†åˆ«é€Ÿåº¦ï¼š2-3ç§’/å¼ 
- å‡†ç¡®ç‡ï¼šå°åˆ·ä½“98%+ï¼Œæ‰‹å†™95%+
- æ”¯æŒæ ¼å¼ï¼šJPGã€PNGã€WebP

---

### 2. æ™ºèƒ½è§£æå¼•æ“ï¼ˆ2åˆ†é’Ÿï¼‰

**æŠ€æœ¯æ ˆï¼š** GLM-4 + Prompt Engineering

**æ ¸å¿ƒå®ç°ï¼š**

```java
/**
 * AIæ™ºèƒ½è§£æ - ç”Ÿæˆè¯¦ç»†è§£æ
 */
public String generateDetailedAnalysis(
    String subject,           // å­¦ç§‘
    String questionContent,   // é¢˜ç›®å†…å®¹
    String correctAnswer,     // æ­£ç¡®ç­”æ¡ˆ
    String userAnswer,        // å­¦ç”Ÿç­”æ¡ˆ
    String difficulty         // éš¾åº¦
) {
    // ç¬¬1æ­¥ï¼šè®¾è®¡ç»“æ„åŒ–Promptï¼ˆæ ¸å¿ƒæŠ€æœ¯ï¼‰
    String prompt = String.format(
        "ä½ æ˜¯ä¸€ä½ä¸“ä¸šçš„%sè€å¸ˆï¼Œè¯·ä¸ºå­¦ç”Ÿè¯¦ç»†è®²è§£è¿™é“é”™é¢˜ã€‚\n\n" +
        
        "ã€é¢˜ç›®ä¿¡æ¯ã€‘\n" +
        "éš¾åº¦ï¼š%s\n" +
        "é¢˜ç›®å†…å®¹ï¼š%s\n" +
        "æ­£ç¡®ç­”æ¡ˆï¼š%s\n" +
        "å­¦ç”Ÿç­”æ¡ˆï¼š%s\n\n" +
        
        "è¯·æŒ‰ä»¥ä¸‹**ä¸¥æ ¼æ ¼å¼**ç”Ÿæˆè¯¦ç»†è§£æï¼ˆæ¯éƒ¨åˆ†éƒ½å¿…é¡»æœ‰ï¼‰ï¼š\n\n" +
        
        "ã€ç¬¬ä¸€æ­¥ï¼šç†è§£é¢˜æ„ã€‘\n" +
        "è¯´æ˜ï¼šï¼ˆç”¨2-3å¥è¯è¯´æ˜è¿™é“é¢˜è€ƒå¯Ÿä»€ä¹ˆï¼Œç»™å‡ºäº†å“ªäº›æ¡ä»¶ï¼‰\n\n" +
        
        "ã€ç¬¬äºŒæ­¥ï¼šåˆ†ææ€è·¯ã€‘\n" +
        "è¯´æ˜ï¼šï¼ˆè¯¦ç»†è§£é‡Šè§£é¢˜æ€è·¯ï¼Œä¸ºä»€ä¹ˆè¦è¿™æ ·åšï¼Œæ¯ä¸€æ­¥çš„åŸå› éƒ½è¦è¯´æ¸…æ¥šï¼‰\n\n" +
        
        "ã€ç¬¬ä¸‰æ­¥ï¼šè¯¦ç»†è®¡ç®—è¿‡ç¨‹ã€‘\n" +
        "è¯´æ˜ï¼šï¼ˆå†™å‡ºå®Œæ•´çš„è®¡ç®—æ­¥éª¤ï¼Œæ¯ä¸€æ­¥éƒ½è¦æœ‰å…·ä½“çš„ç®—å¼ï¼Œä¸èƒ½è·³æ­¥ï¼‰\n" +
        "è®¡ç®—ï¼š\n" +
        "ï¼ˆå…·ä½“çš„è®¡ç®—è¿‡ç¨‹ï¼Œæ¯ä¸ªç­‰å¼éƒ½å†™å‡ºæ¥ï¼‰\n\n" +
        
        "ã€ç¬¬å››æ­¥ï¼šé”™è¯¯åˆ†æã€‘\n" +
        "å­¦ç”Ÿçš„ç­”æ¡ˆæ˜¯ï¼š%s\n" +
        "é”™è¯¯åŸå› ï¼šï¼ˆåˆ†æä¸ºä»€ä¹ˆä¼šåšé”™ï¼Œæ˜¯æ¦‚å¿µä¸æ¸…è¿˜æ˜¯è®¡ç®—å¤±è¯¯ï¼‰\n" +
        "æ­£ç¡®åšæ³•ï¼šï¼ˆå¼ºè°ƒæ­£ç¡®çš„æ–¹æ³•ï¼‰\n\n" +
        
        "ã€ç¬¬äº”æ­¥ï¼šçŸ¥è¯†ç‚¹æ€»ç»“ã€‘\n" +
        "æ¶‰åŠçŸ¥è¯†ç‚¹ï¼šï¼ˆåˆ—å‡º3-5ä¸ªç›¸å…³çŸ¥è¯†ç‚¹ï¼‰\n\n" +
        
        "ã€ç¬¬å…­æ­¥ï¼šæ˜“é”™æé†’ã€‘\n" +
        "æ³¨æ„äº‹é¡¹ï¼šï¼ˆåˆ—å‡º2-3ä¸ªè¿™ç±»é¢˜ç›®å®¹æ˜“çŠ¯çš„é”™è¯¯ï¼‰\n\n" +
        
        "ã€ç¬¬ä¸ƒæ­¥ï¼šç›¸ä¼¼é¢˜ç›®ã€‘\n" +
        "æ¨èç»ƒä¹ ï¼šï¼ˆæè¿°1-2é“ç±»ä¼¼é¢˜ç›®ï¼Œç”¨äºå·©å›ºï¼‰\n\n" +
        
        "ã€ç¬¬å…«æ­¥ï¼šå­¦ä¹ å»ºè®®ã€‘\n" +
        "å»ºè®®ï¼šï¼ˆç»™å­¦ç”Ÿçš„å…·ä½“å­¦ä¹ å»ºè®®ï¼‰\n\n" +
        
        "=== æ ¼å¼è¦æ±‚ ===\n" +
        "1. æ¯ä¸ªã€ã€‘æ ‡é¢˜éƒ½å¿…é¡»ä¿ç•™\n" +
        "2. æ¯ä¸ªæ­¥éª¤çš„'è¯´æ˜'éƒ¨åˆ†å¿…é¡»å†™è‡³å°‘2å¥å®Œæ•´çš„è¯\n" +
        "3. è®¡ç®—è¿‡ç¨‹è¦å†™å‡ºå…·ä½“çš„ç®—å¼ï¼Œä¸èƒ½åªå†™ç»“æœ\n" +
        "4. æ€»å­—æ•°ä¸å°‘äº500å­—\n" +
        "5. è¯­è¨€è¦åƒè€å¸ˆåœ¨é»‘æ¿å‰è®²è¯¾ä¸€æ ·è¯¦ç»†å’Œé€šä¿—",
        
        subject, difficulty, questionContent, correctAnswer, userAnswer, userAnswer
    );
    
    // ç¬¬2æ­¥ï¼šè°ƒç”¨GLM-4ç”Ÿæˆè§£æ
    // temperature=0.7 å¹³è¡¡åˆ›é€ æ€§å’Œå‡†ç¡®æ€§
    String analysis = callGLM(prompt, 0.7);
    
    // ç¬¬3æ­¥ï¼šè´¨é‡æ£€æŸ¥
    if (analysis.length() < 500) {
        log.warn("è§£æå­—æ•°ä¸è¶³500å­—ï¼Œé‡æ–°ç”Ÿæˆ");
        // å¯ä»¥åŠ å…¥é‡è¯•æœºåˆ¶
    }
    
    return analysis;
}

/**
 * è°ƒç”¨GLM APIçš„æ ¸å¿ƒæ–¹æ³•
 */
private String callGLM(String prompt, double temperature) {
    String apiKey = "ä½ çš„APIå¯†é’¥";
    String apiUrl = "https://open.bigmodel.cn/api/paas/v4/chat/completions";
    
    // æ„å»ºè¯·æ±‚
    JSONObject requestBody = new JSONObject();
    requestBody.put("model", "glm-4");
    requestBody.put("temperature", temperature);
    
    JSONArray messages = new JSONArray();
    JSONObject message = new JSONObject();
    message.put("role", "user");
    message.put("content", prompt);
    messages.add(message);
    requestBody.put("messages", messages);
    
    // å‘é€HTTPè¯·æ±‚
    HttpHeaders headers = new HttpHeaders();
    headers.setContentType(MediaType.APPLICATION_JSON);
    headers.set("Authorization", "Bearer " + apiKey);
    
    HttpEntity<String> entity = new HttpEntity<>(requestBody.toJSONString(), headers);
    ResponseEntity<String> response = restTemplate.postForEntity(apiUrl, entity, String.class);
    
    // è§£æå“åº”
    JSONObject result = JSON.parseObject(response.getBody());
    return result.getJSONArray("choices")
        .getJSONObject(0)
        .getJSONObject("message")
        .getString("content");
}
```

**æ ¸å¿ƒæŠ€æœ¯ç‚¹ï¼š**

1. **ç»“æ„åŒ–Promptè®¾è®¡**ï¼ˆæœ€å…³é”®ï¼‰
   - 8ä¸ªæ­¥éª¤ï¼Œå¼ºåˆ¶AIç”Ÿæˆè¯¦ç»†è§£æ
   - æ˜ç¡®æ ¼å¼è¦æ±‚ï¼Œç¡®ä¿è´¨é‡
   - 500å­—+å¼ºåˆ¶è¦æ±‚

2. **å‚æ•°ä¼˜åŒ–**
   - temperature=0.7ï¼šå¹³è¡¡å‡†ç¡®æ€§å’Œå¤šæ ·æ€§
   - å¤ªä½(0.1)ï¼šè§£ææ­»æ¿
   - å¤ªé«˜(0.9)ï¼šå¯èƒ½åé¢˜

3. **è´¨é‡ä¿è¯æœºåˆ¶**
   - å­—æ•°æ£€æŸ¥
   - æ ¼å¼éªŒè¯
   - é‡è¯•æœºåˆ¶

**æ•ˆæœï¼š**
- å¹³å‡è§£æé•¿åº¦ï¼š580å­—
- å­¦ç”Ÿæ»¡æ„åº¦ï¼š4.2/5
- AIå‡†ç¡®ç‡ï¼š92%+

---

### 3. çŸ¥è¯†å›¾è°±æ„å»ºç®—æ³•ï¼ˆ2åˆ†é’Ÿï¼‰

**æŠ€æœ¯æ ˆï¼š** AI + å›¾ç®—æ³• + æ ‘ç»“æ„

**ç®—æ³•æµç¨‹ï¼š**

```java
@Service
public class MindMapService {
    
    /**
     * ç”ŸæˆçŸ¥è¯†å›¾è°±
     */
    public MindMapData generateMindMap(String questionContent, String subject) {
        
        // æ­¥éª¤1ï¼šAIæå–çŸ¥è¯†ç‚¹
        List<String> knowledgePoints = extractKnowledgePoints(questionContent, subject);
        
        // æ­¥éª¤2ï¼šAIåˆ†æçŸ¥è¯†å…³ç³»
        String knowledgeStructure = analyzeKnowledgeRelations(knowledgePoints, subject);
        
        // æ­¥éª¤3ï¼šè§£æä¸ºå›¾æ•°æ®ç»“æ„
        MindMapData mindMap = parseToGraph(knowledgeStructure);
        
        // æ­¥éª¤4ï¼šè®¡ç®—èŠ‚ç‚¹é‡è¦åº¦
        calculateNodeImportance(mindMap);
        
        return mindMap;
    }
    
    /**
     * æ­¥éª¤1ï¼šæå–çŸ¥è¯†ç‚¹
     */
    private List<String> extractKnowledgePoints(String content, String subject) {
        String prompt = String.format(
            "è¯·åˆ†æä»¥ä¸‹%sé¢˜ç›®ï¼Œæå–å‡ºæ¶‰åŠçš„æ‰€æœ‰çŸ¥è¯†ç‚¹ã€‚\n\n" +
            "ã€é¢˜ç›®ã€‘%s\n\n" +
            "è¦æ±‚ï¼š\n" +
            "1. åªè¿”å›çŸ¥è¯†ç‚¹åˆ—è¡¨ï¼Œæ¯è¡Œä¸€ä¸ª\n" +
            "2. æŒ‰ç…§ä»ä¸»è¦åˆ°æ¬¡è¦æ’åº\n" +
            "3. çŸ¥è¯†ç‚¹è¦å…·ä½“ã€å‡†ç¡®\n" +
            "4. ä¸è¦æœ‰ç¼–å·ï¼Œç›´æ¥åˆ—å‡ºçŸ¥è¯†ç‚¹åç§°",
            subject, content
        );
        
        String response = glmService.callGLM(prompt, 0.3);
        return Arrays.asList(response.split("\n"));
    }
    
    /**
     * æ­¥éª¤2ï¼šåˆ†æçŸ¥è¯†å…³ç³»ï¼ˆæ ¸å¿ƒç®—æ³•ï¼‰
     */
    private String analyzeKnowledgeRelations(List<String> knowledgePoints, String subject) {
        String prompt = String.format(
            "è¯·åˆ†æä»¥ä¸‹%sçŸ¥è¯†ç‚¹ä¹‹é—´çš„å…³ç³»ï¼Œæ„å»ºçŸ¥è¯†å›¾è°±ã€‚\n\n" +
            "ã€çŸ¥è¯†ç‚¹åˆ—è¡¨ã€‘\n%s\n\n" +
            "è¯·æŒ‰ä»¥ä¸‹æ ¼å¼è¾“å‡ºï¼ˆä¸¥æ ¼æŒ‰æ ¼å¼ï¼‰ï¼š\n\n" +
            "# æ ¹èŠ‚ç‚¹åç§°\n" +
            "## å‰ç½®çŸ¥è¯†ï¼ˆéœ€è¦å…ˆæŒæ¡çš„ï¼‰\n" +
            "### çŸ¥è¯†ç‚¹1\n" +
            "æè¿°ï¼šè¿™ä¸ªçŸ¥è¯†ç‚¹çš„ç®€è¦è¯´æ˜\n" +
            "### çŸ¥è¯†ç‚¹2\n" +
            "æè¿°ï¼š...\n" +
            "## å½“å‰çŸ¥è¯†ï¼ˆé¢˜ç›®è€ƒå¯Ÿçš„ï¼‰\n" +
            "### çŸ¥è¯†ç‚¹3\n" +
            "æè¿°ï¼š...\n" +
            "## åç»­çŸ¥è¯†ï¼ˆæŒæ¡åå¯å­¦ä¹ çš„ï¼‰\n" +
            "### çŸ¥è¯†ç‚¹4\n" +
            "æè¿°ï¼š...\n\n" +
            "å…³ç³»ï¼š\n" +
            "- çŸ¥è¯†ç‚¹1 -> çŸ¥è¯†ç‚¹3 : ä¾èµ–ï¼ˆçŸ¥è¯†ç‚¹3ä¾èµ–çŸ¥è¯†ç‚¹1ï¼‰\n" +
            "- çŸ¥è¯†ç‚¹3 -> çŸ¥è¯†ç‚¹4 : åº”ç”¨ï¼ˆçŸ¥è¯†ç‚¹4æ˜¯çŸ¥è¯†ç‚¹3çš„åº”ç”¨ï¼‰\n",
            subject, String.join("\n", knowledgePoints)
        );
        
        return glmService.callGLM(prompt, 0.5);
    }
    
    /**
     * æ­¥éª¤3ï¼šè§£æä¸ºå›¾æ•°æ®ç»“æ„
     */
    private MindMapData parseToGraph(String structure) {
        MindMapData graph = new MindMapData();
        List<Node> nodes = new ArrayList<>();
        List<Edge> edges = new ArrayList<>();
        
        String[] lines = structure.split("\n");
        Map<String, Node> nodeMap = new HashMap<>();
        int nodeIdCounter = 1;
        
        for (String line : lines) {
            line = line.trim();
            if (line.isEmpty()) continue;
            
            // è§£æèŠ‚ç‚¹ï¼ˆ# ## ### ä»£è¡¨å±‚çº§ï¼‰
            if (line.startsWith("#")) {
                int level = countHashSymbols(line);
                String nodeName = line.substring(level).trim();
                
                Node node = new Node();
                node.setId("node_" + nodeIdCounter++);
                node.setName(nodeName);
                node.setLevel(level - 1);
                
                nodeMap.put(nodeName, node);
                nodes.add(node);
            }
            
            // è§£æå…³ç³»ï¼ˆ- A -> B : ç±»å‹ï¼‰
            else if (line.startsWith("-")) {
                String[] parts = line.substring(1).split("->");
                if (parts.length == 2) {
                    String from = parts[0].trim();
                    String[] toParts = parts[1].split(":");
                    String to = toParts[0].trim();
                    String relation = toParts.length > 1 ? toParts[1].trim() : "å…³è”";
                    
                    Edge edge = new Edge();
                    edge.setFrom(nodeMap.get(from).getId());
                    edge.setTo(nodeMap.get(to).getId());
                    edge.setRelation(relation);
                    edges.add(edge);
                }
            }
        }
        
        graph.setNodes(nodes);
        graph.setEdges(edges);
        return graph;
    }
    
    /**
     * æ­¥éª¤4ï¼šè®¡ç®—èŠ‚ç‚¹é‡è¦åº¦ï¼ˆPageRankæ€æƒ³ï¼‰
     */
    private void calculateNodeImportance(MindMapData graph) {
        Map<String, Double> importance = new HashMap<>();
        
        // åˆå§‹åŒ–ï¼šæ‰€æœ‰èŠ‚ç‚¹é‡è¦åº¦ = 1.0 / èŠ‚ç‚¹æ•°
        double initValue = 1.0 / graph.getNodes().size();
        for (Node node : graph.getNodes()) {
            importance.put(node.getId(), initValue);
        }
        
        // è¿­ä»£è®¡ç®—ï¼ˆç®€åŒ–ç‰ˆPageRankï¼‰
        for (int i = 0; i < 10; i++) {
            Map<String, Double> newImportance = new HashMap<>();
            
            for (Node node : graph.getNodes()) {
                double sum = 0.0;
                
                // è®¡ç®—å…¥è¾¹è´¡çŒ®
                for (Edge edge : graph.getEdges()) {
                    if (edge.getTo().equals(node.getId())) {
                        String fromId = edge.getFrom();
                        int outDegree = countOutEdges(fromId, graph.getEdges());
                        sum += importance.get(fromId) / outDegree;
                    }
                }
                
                newImportance.put(node.getId(), 0.15 + 0.85 * sum);
            }
            
            importance = newImportance;
        }
        
        // è®¾ç½®é‡è¦åº¦
        for (Node node : graph.getNodes()) {
            node.setImportance(importance.get(node.getId()));
        }
    }
}
```

**æ ¸å¿ƒæŠ€æœ¯ç‚¹ï¼š**

1. **ä¸¤é˜¶æ®µAIå¤„ç†**
   - é˜¶æ®µ1ï¼šæå–çŸ¥è¯†ç‚¹ï¼ˆtemperature=0.3ï¼Œæ›´å‡†ç¡®ï¼‰
   - é˜¶æ®µ2ï¼šåˆ†æå…³ç³»ï¼ˆtemperature=0.5ï¼Œæ›´çµæ´»ï¼‰

2. **å›¾ç®—æ³•åº”ç”¨**
   - èŠ‚ç‚¹ï¼ˆNodeï¼‰ï¼šçŸ¥è¯†ç‚¹
   - è¾¹ï¼ˆEdgeï¼‰ï¼šä¾èµ–/åº”ç”¨å…³ç³»
   - PageRankï¼šè®¡ç®—é‡è¦åº¦

3. **æ ‘çŠ¶ç»“æ„è§£æ**
   - è§£æMarkdownæ ¼å¼ï¼ˆ# ## ###ï¼‰
   - æ„å»ºå±‚çº§å…³ç³»
   - è§£æå…³ç³»æè¿°

**æ•°æ®ç»“æ„ï¼š**
```json
{
  "nodes": [
    {"id": "1", "name": "å‡½æ•°æ¦‚å¿µ", "level": 0, "importance": 0.8},
    {"id": "2", "name": "æé™å®šä¹‰", "level": 1, "importance": 0.9},
    {"id": "3", "name": "å¯¼æ•°å®šä¹‰", "level": 2, "importance": 1.0}
  ],
  "edges": [
    {"from": "1", "to": "2", "relation": "å‰ç½®"},
    {"from": "2", "to": "3", "relation": "ä¾èµ–"}
  ]
}
```

---

### 4. æ™ºèƒ½æ¨èç®—æ³•ï¼ˆ2åˆ†é’Ÿï¼‰

**ç®—æ³•ç±»å‹ï¼š** ååŒè¿‡æ»¤ + å†…å®¹æ¨è + çŸ¥è¯†ç‚¹åŒ¹é…

**å®ç°ä»£ç ï¼š**

```java
@Service
public class RecommendationService {
    
    /**
     * è·å–ä¸ªæ€§åŒ–æ¨èé¢˜ç›®
     * 
     * ç®—æ³•ï¼šæ··åˆæ¨è
     * 1. åŸºäºçŸ¥è¯†ç‚¹çš„å†…å®¹æ¨èï¼ˆ70%æƒé‡ï¼‰
     * 2. åŸºäºç›¸ä¼¼åº¦çš„ååŒè¿‡æ»¤ï¼ˆ20%æƒé‡ï¼‰
     * 3. åŸºäºéš¾åº¦çš„è‡ªé€‚åº”æ¨èï¼ˆ10%æƒé‡ï¼‰
     */
    public List<Question> getRecommendedQuestions(User user, int limit) {
        
        // ç¬¬1æ­¥ï¼šåˆ†æç”¨æˆ·è–„å¼±çŸ¥è¯†ç‚¹
        Map<Long, WeaknessInfo> weaknessMap = analyzeWeakness(user);
        
        // ç¬¬2æ­¥ï¼šè®¡ç®—æ¯é“é¢˜çš„æ¨èåˆ†æ•°
        List<QuestionScore> scoredQuestions = new ArrayList<>();
        List<Question> allQuestions = questionRepository.findAll();
        
        for (Question question : allQuestions) {
            // æ’é™¤å·²åšè¿‡çš„é¢˜
            if (userHasAnswered(user, question)) continue;
            
            double score = calculateRecommendationScore(question, weaknessMap, user);
            scoredQuestions.add(new QuestionScore(question, score));
        }
        
        // ç¬¬3æ­¥ï¼šæ’åºå¹¶è¿”å›TOP N
        return scoredQuestions.stream()
            .sorted((a, b) -> Double.compare(b.getScore(), a.getScore()))
            .limit(limit)
            .map(QuestionScore::getQuestion)
            .collect(Collectors.toList());
    }
    
    /**
     * åˆ†æç”¨æˆ·è–„å¼±çŸ¥è¯†ç‚¹
     */
    private Map<Long, WeaknessInfo> analyzeWeakness(User user) {
        List<ErrorBook> errors = errorBookRepository.findByUser(user);
        Map<Long, WeaknessInfo> weaknessMap = new HashMap<>();
        
        for (ErrorBook error : errors) {
            List<QuestionKnowledge> qks = questionKnowledgeRepository
                .findByQuestionId(error.getQuestion().getId());
            
            for (QuestionKnowledge qk : qks) {
                Long knowledgeId = qk.getKnowledge().getId();
                WeaknessInfo info = weaknessMap.getOrDefault(
                    knowledgeId, 
                    new WeaknessInfo(knowledgeId)
                );
                
                // ç»Ÿè®¡é”™è¯¯æ¬¡æ•°
                info.incrementErrorCount();
                
                // è®¡ç®—æœ€è¿‘é”™è¯¯æ—¶é—´æƒé‡ï¼ˆè¶Šè¿‘æƒé‡è¶Šé«˜ï¼‰
                long daysSinceError = ChronoUnit.DAYS.between(
                    error.getCreatedAt(), 
                    LocalDateTime.now()
                );
                double timeWeight = Math.exp(-daysSinceError / 30.0);
                info.addTimeWeight(timeWeight);
                
                weaknessMap.put(knowledgeId, info);
            }
        }
        
        return weaknessMap;
    }
    
    /**
     * è®¡ç®—æ¨èåˆ†æ•°ï¼ˆæ ¸å¿ƒç®—æ³•ï¼‰
     */
    private double calculateRecommendationScore(
        Question question, 
        Map<Long, WeaknessInfo> weaknessMap,
        User user
    ) {
        double score = 0.0;
        
        // 1. çŸ¥è¯†ç‚¹åŒ¹é…åˆ†æ•°ï¼ˆ70%æƒé‡ï¼‰
        List<QuestionKnowledge> qks = questionKnowledgeRepository
            .findByQuestionId(question.getId());
        
        for (QuestionKnowledge qk : qks) {
            Long knowledgeId = qk.getKnowledge().getId();
            if (weaknessMap.containsKey(knowledgeId)) {
                WeaknessInfo info = weaknessMap.get(knowledgeId);
                // é”™è¯¯æ¬¡æ•°è¶Šå¤šï¼Œåˆ†æ•°è¶Šé«˜
                score += info.getErrorCount() * 0.7 * info.getAvgTimeWeight();
            }
        }
        
        // 2. ç›¸ä¼¼åº¦åˆ†æ•°ï¼ˆ20%æƒé‡ï¼‰
        double similarityScore = calculateSimilarity(question, user);
        score += similarityScore * 0.2;
        
        // 3. éš¾åº¦é€‚é…åˆ†æ•°ï¼ˆ10%æƒé‡ï¼‰
        double difficultyScore = calculateDifficultyMatch(question, user);
        score += difficultyScore * 0.1;
        
        // 4. å¤šæ ·æ€§æƒ©ç½šï¼ˆé¿å…æ¨èå¤ªå¤šç›¸åŒç±»å‹ï¼‰
        score *= getDiversityPenalty(question, user);
        
        return score;
    }
    
    /**
     * è®¡ç®—ç›¸ä¼¼åº¦ï¼ˆåŸºäºé¢˜ç›®å‘é‡åŒ–ï¼‰
     */
    private double calculateSimilarity(Question question, User user) {
        // ç®€åŒ–ç‰ˆï¼šåŸºäºçŸ¥è¯†ç‚¹äº¤é›†
        List<ErrorBook> userErrors = errorBookRepository.findByUser(user);
        if (userErrors.isEmpty()) return 0.0;
        
        // è·å–ç”¨æˆ·å¸¸é”™é¢˜ç›®çš„çŸ¥è¯†ç‚¹é›†åˆ
        Set<Long> userKnowledgeSet = new HashSet<>();
        for (ErrorBook error : userErrors) {
            questionKnowledgeRepository.findByQuestionId(error.getQuestion().getId())
                .forEach(qk -> userKnowledgeSet.add(qk.getKnowledge().getId()));
        }
        
        // è·å–å½“å‰é¢˜ç›®çš„çŸ¥è¯†ç‚¹é›†åˆ
        Set<Long> questionKnowledgeSet = questionKnowledgeRepository
            .findByQuestionId(question.getId())
            .stream()
            .map(qk -> qk.getKnowledge().getId())
            .collect(Collectors.toSet());
        
        // Jaccardç›¸ä¼¼åº¦ = äº¤é›† / å¹¶é›†
        Set<Long> intersection = new HashSet<>(userKnowledgeSet);
        intersection.retainAll(questionKnowledgeSet);
        
        Set<Long> union = new HashSet<>(userKnowledgeSet);
        union.addAll(questionKnowledgeSet);
        
        return union.isEmpty() ? 0.0 : (double) intersection.size() / union.size();
    }
    
    /**
     * éš¾åº¦åŒ¹é…ï¼ˆè‡ªé€‚åº”éš¾åº¦ï¼‰
     */
    private double calculateDifficultyMatch(Question question, User user) {
        // åˆ†æç”¨æˆ·å½“å‰æ°´å¹³
        double userLevel = calculateUserLevel(user);
        
        // é¢˜ç›®éš¾åº¦ï¼ˆç®€å•=1, ä¸­ç­‰=2, å›°éš¾=3ï¼‰
        int questionDifficulty = parseDifficulty(question.getDifficulty());
        
        // æœ€ä½³éš¾åº¦ = ç”¨æˆ·æ°´å¹³ + 0.5ï¼ˆç•¥æœ‰æŒ‘æˆ˜ï¼‰
        double optimalDifficulty = userLevel + 0.5;
        
        // è·ç¦»è¶Šè¿‘ï¼Œåˆ†æ•°è¶Šé«˜
        double distance = Math.abs(questionDifficulty - optimalDifficulty);
        return Math.exp(-distance);
    }
}
```

**ç®—æ³•ç‰¹ç‚¹ï¼š**

1. **å¤šå› ç´ åŠ æƒ**
   - çŸ¥è¯†ç‚¹åŒ¹é…ï¼š70%
   - ç›¸ä¼¼åº¦ï¼š20%
   - éš¾åº¦ï¼š10%

2. **æ—¶é—´è¡°å‡**
   - æœ€è¿‘é”™è¯¯çš„çŸ¥è¯†ç‚¹æƒé‡æ›´é«˜
   - ä½¿ç”¨æŒ‡æ•°è¡°å‡å‡½æ•°

3. **è‡ªé€‚åº”éš¾åº¦**
   - æ ¹æ®ç”¨æˆ·æ°´å¹³æ¨èåˆé€‚éš¾åº¦
   - ç•¥é«˜äºå½“å‰æ°´å¹³ï¼ˆæŒ‘æˆ˜æ€§ï¼‰

4. **å¤šæ ·æ€§æ§åˆ¶**
   - é¿å…æ¨èå¤ªå¤šç›¸åŒç±»å‹
   - ä¿æŒæ¨èåˆ—è¡¨å¤šæ ·æ€§

---

## ç¬¬å››éƒ¨åˆ†ï¼šå…³é”®æŠ€æœ¯éš¾ç‚¹ä¸è§£å†³æ–¹æ¡ˆï¼ˆ4åˆ†é’Ÿï¼‰â­

### éš¾ç‚¹1ï¼šæ•°å­¦å…¬å¼è¯†åˆ«ä¸æ¸²æŸ“ï¼ˆâ­â­â­â­â­ï¼‰

**é—®é¢˜ï¼š**
- æ™®é€šOCRæ— æ³•è¯†åˆ«æ•°å­¦å…¬å¼
- åˆ†æ•°ã€æ ¹å·ã€ç§¯åˆ†ç­‰ç¬¦å·éš¾ä»¥å¤„ç†

**è§£å†³æ–¹æ¡ˆï¼š**

```java
/**
 * æ•°å­¦å…¬å¼å¤„ç†
 */
public class MathFormulaProcessor {
    
    /**
     * æ­¥éª¤1ï¼šGLM-4Vè¯†åˆ«å…¬å¼
     */
    public String recognizeFormula(byte[] imageBytes) {
        String prompt = 
            "è¯·è¯†åˆ«å›¾ç‰‡ä¸­çš„æ•°å­¦å…¬å¼ï¼Œç”¨LaTeXæ ¼å¼è¡¨ç¤ºã€‚\n" +
            "ä¾‹å¦‚ï¼šåˆ†æ•° 2/3 å†™æˆ \\frac{2}{3}\n" +
            "     æ ¹å· âˆš2 å†™æˆ \\sqrt{2}\n" +
            "     ç§¯åˆ† âˆ« å†™æˆ \\int";
        
        return glmService.recognizeImageWithPrompt(imageBytes, prompt);
    }
    
    /**
     * æ­¥éª¤2ï¼šåå¤„ç† - è½¬æ¢ä¸ºæ¸²æŸ“æ ¼å¼
     */
    public String processFormula(String latexFormula) {
        // ç®€å•æ›¿æ¢ï¼ˆå¸¸è§ç¬¦å·ï¼‰
        Map<String, String> replacements = Map.of(
            "\\frac{", "<sup>",
            "}{", "</sup>/<sub>",
            "}", "</sub>",
            "\\sqrt{", "âˆš(",
            "^", "<sup>",
            "_", "<sub>"
        );
        
        String processed = latexFormula;
        for (Map.Entry<String, String> entry : replacements.entrySet()) {
            processed = processed.replace(entry.getKey(), entry.getValue());
        }
        
        return processed;
    }
    
    /**
     * æ­¥éª¤3ï¼šå‰ç«¯æ¸²æŸ“
     * ä½¿ç”¨MathJaxæˆ–KaTeXåº“
     */
    // å‰ç«¯ä»£ç ï¼ˆVue 3ï¼‰
    // <template>
    //   <div v-html="renderFormula(formula)"></div>
    // </template>
    //
    // <script setup>
    // import { renderMathInElement } from 'katex';
    // 
    // const renderFormula = (latex) => {
    //   return katex.renderToString(latex, {
    //     throwOnError: false
    //   });
    // };
    // </script>
}
```

**æ•ˆæœï¼š**
- å…¬å¼è¯†åˆ«å‡†ç¡®ç‡ï¼š92%+
- æ”¯æŒå¤æ‚å…¬å¼ï¼ˆåˆ†å¼ã€æ ¹å¼ã€ç§¯åˆ†ã€æ±‚å’Œç­‰ï¼‰

---

### éš¾ç‚¹2ï¼šAIè§£æè´¨é‡æ§åˆ¶ï¼ˆâ­â­â­â­ï¼‰

**é—®é¢˜ï¼š**
- AIç”Ÿæˆçš„è§£ææœ‰æ—¶å¤ªç®€å•
- æœ‰æ—¶ä¼šå‡ºç°å¹»è§‰ï¼ˆèƒ¡è¯´å…«é“ï¼‰

**è§£å†³æ–¹æ¡ˆï¼š**

**1. å¼ºåˆ¶è¯¦ç»†Prompt**
```java
String prompt = 
    "=== æ ¼å¼è¦æ±‚ ===\n" +
    "1. æ¯ä¸ªã€ã€‘æ ‡é¢˜éƒ½å¿…é¡»ä¿ç•™\n" +
    "2. æ¯ä¸ªæ­¥éª¤çš„'è¯´æ˜'éƒ¨åˆ†å¿…é¡»å†™è‡³å°‘2å¥å®Œæ•´çš„è¯\n" +
    "3. è®¡ç®—è¿‡ç¨‹è¦å†™å‡ºå…·ä½“çš„ç®—å¼ï¼Œä¸èƒ½åªå†™ç»“æœ\n" +
    "4. æ€»å­—æ•°ä¸å°‘äº500å­—\n" +
    "5. è¯­è¨€è¦åƒè€å¸ˆåœ¨é»‘æ¿å‰è®²è¯¾ä¸€æ ·è¯¦ç»†å’Œé€šä¿—";
```

**2. è´¨é‡æ£€æŸ¥æœºåˆ¶**
```java
public String generateAnalysisWithQualityCheck(Question question) {
    String analysis = glmService.generateAnalysis(question);
    
    // æ£€æŸ¥1ï¼šå­—æ•°
    if (analysis.length() < 500) {
        log.warn("è§£æå­—æ•°ä¸è¶³ï¼Œé‡æ–°ç”Ÿæˆ");
        analysis = glmService.generateAnalysis(question);
    }
    
    // æ£€æŸ¥2ï¼šå¿…éœ€æ ‡é¢˜
    String[] requiredTitles = {
        "ã€ç¬¬ä¸€æ­¥ï¼šç†è§£é¢˜æ„ã€‘",
        "ã€ç¬¬äºŒæ­¥ï¼šåˆ†ææ€è·¯ã€‘",
        "ã€ç¬¬ä¸‰æ­¥ï¼šè¯¦ç»†è®¡ç®—è¿‡ç¨‹ã€‘"
    };
    for (String title : requiredTitles) {
        if (!analysis.contains(title)) {
            log.warn("ç¼ºå°‘å¿…éœ€æ ‡é¢˜ï¼š{}", title);
            // é‡æ–°ç”Ÿæˆæˆ–ä¿®å¤
        }
    }
    
    // æ£€æŸ¥3ï¼šå¹»è§‰æ£€æµ‹ï¼ˆå…³é”®è¯æ£€æµ‹ï¼‰
    if (containsHallucination(analysis)) {
        log.warn("æ£€æµ‹åˆ°å¯èƒ½çš„å¹»è§‰å†…å®¹");
        // ä½¿ç”¨æ›´ä¿å®ˆçš„temperatureé‡æ–°ç”Ÿæˆ
        analysis = glmService.generateAnalysis(question, 0.3);
    }
    
    return analysis;
}

private boolean containsHallucination(String text) {
    // æ£€æµ‹å¹»è§‰çš„å¸¸è§æ¨¡å¼
    String[] patterns = {
        "æˆ‘å»ºè®®ä½ ", "æˆ‘æ— æ³•", "ä½œä¸ºä¸€ä¸ªAI",
        "æ— æ³•ç¡®å®š", "å¯èƒ½æ˜¯", "ä¸ç¡®å®š"
    };
    for (String pattern : patterns) {
        if (text.contains(pattern)) return true;
    }
    return false;
}
```

**3. äººå·¥å®¡æ ¸+åé¦ˆå¾ªç¯**
- æ•™å¸ˆå¯ä»¥ä¸¾æŠ¥ä½è´¨é‡è§£æ
- è®°å½•é—®é¢˜æ¡ˆä¾‹ï¼Œä¼˜åŒ–Prompt

---

### éš¾ç‚¹3ï¼šé«˜å¹¶å‘å¤„ç†ï¼ˆâ­â­â­â­ï¼‰

**é—®é¢˜ï¼š**
- AIåˆ†æè€—æ—¶è¾ƒé•¿ï¼ˆ3-5ç§’ï¼‰
- å¤šäººåŒæ—¶ä½¿ç”¨ä¼šæ’é˜Ÿ

**è§£å†³æ–¹æ¡ˆï¼š**

**1. å¼‚æ­¥å¤„ç†æ¶æ„**

```java
@Service
public class AsyncAnalysisService {
    
    @Autowired
    private TaskExecutor taskExecutor;  // çº¿ç¨‹æ± 
    
    /**
     * å¼‚æ­¥AIåˆ†æ
     */
    @Async("aiAnalysisExecutor")
    public CompletableFuture<String> analyzeAsync(Question question) {
        return CompletableFuture.supplyAsync(() -> {
            try {
                return glmService.generateAnalysis(question);
            } catch (Exception e) {
                log.error("AIåˆ†æå¤±è´¥", e);
                return "åˆ†æå¤±è´¥ï¼Œè¯·ç¨åé‡è¯•";
            }
        }, taskExecutor);
    }
    
    /**
     * çº¿ç¨‹æ± é…ç½®
     */
    @Configuration
    public class AsyncConfig {
        @Bean("aiAnalysisExecutor")
        public TaskExecutor aiAnalysisExecutor() {
            ThreadPoolTaskExecutor executor = new ThreadPoolTaskExecutor();
            executor.setCorePoolSize(10);      // æ ¸å¿ƒçº¿ç¨‹æ•°
            executor.setMaxPoolSize(50);       // æœ€å¤§çº¿ç¨‹æ•°
            executor.setQueueCapacity(100);    // é˜Ÿåˆ—å®¹é‡
            executor.setThreadNamePrefix("ai-analysis-");
            executor.initialize();
            return executor;
        }
    }
}
```

**2. Redisç¼“å­˜ç­–ç•¥**

```java
@Service
public class CacheService {
    
    @Autowired
    private RedisTemplate<String, String> redisTemplate;
    
    /**
     * ç¼“å­˜AIè§£æç»“æœ
     */
    public String getOrGenerateAnalysis(Question question) {
        // ç”Ÿæˆç¼“å­˜keyï¼ˆåŸºäºé¢˜ç›®å†…å®¹hashï¼‰
        String cacheKey = "analysis:" + 
            DigestUtils.md5Hex(question.getContent());
        
        // å…ˆæŸ¥ç¼“å­˜
        String cachedAnalysis = redisTemplate.opsForValue().get(cacheKey);
        if (cachedAnalysis != null) {
            log.info("å‘½ä¸­ç¼“å­˜ï¼š{}", cacheKey);
            return cachedAnalysis;
        }
        
        // ç¼“å­˜æœªå‘½ä¸­ï¼Œè°ƒç”¨AIç”Ÿæˆ
        String analysis = glmService.generateAnalysis(question);
        
        // å­˜å…¥ç¼“å­˜ï¼ˆ7å¤©è¿‡æœŸï¼‰
        redisTemplate.opsForValue().set(
            cacheKey, 
            analysis, 
            7, 
            TimeUnit.DAYS
        );
        
        return analysis;
    }
}
```

**3. æ•°æ®åº“ä¼˜åŒ–**

```sql
-- å»ºç«‹ç´¢å¼•ï¼ŒåŠ é€ŸæŸ¥è¯¢
CREATE INDEX idx_question_subject ON questions(subject);
CREATE INDEX idx_question_difficulty ON questions(difficulty);
CREATE INDEX idx_errorbook_user_time ON error_books(user_id, created_at DESC);
CREATE INDEX idx_knowledge_point ON question_knowledge(knowledge_id);

-- æŸ¥è¯¢ä¼˜åŒ–ç¤ºä¾‹
SELECT q.* FROM questions q
JOIN question_knowledge qk ON q.id = qk.question_id
WHERE qk.knowledge_id IN (1, 2, 3)  -- è–„å¼±çŸ¥è¯†ç‚¹
  AND q.id NOT IN (  -- æ’é™¤å·²åšè¿‡çš„
    SELECT question_id FROM error_books WHERE user_id = ?
  )
LIMIT 10;
```

**æ€§èƒ½æå‡ï¼š**
- å“åº”æ—¶é—´ï¼šä»5ç§’é™è‡³0.3ç§’ï¼ˆç¼“å­˜å‘½ä¸­æ—¶ï¼‰
- å¹¶å‘èƒ½åŠ›ï¼šä»10æå‡è‡³1000+
- ç¼“å­˜å‘½ä¸­ç‡ï¼š65%

---

## ç¬¬äº”éƒ¨åˆ†ï¼šæ€§èƒ½ä¼˜åŒ–ä¸å¹¶å‘å¤„ç†ï¼ˆ2åˆ†é’Ÿï¼‰

### 1. å‰ç«¯æ€§èƒ½ä¼˜åŒ–

**æŠ€æœ¯ç‚¹ï¼š**

```typescript
// 1. è·¯ç”±æ‡’åŠ è½½
const routes = [
  {
    path: '/errorbook',
    component: () => import('@/views/ErrorBook.vue')  // æ‡’åŠ è½½
  }
];

// 2. å›¾ç‰‡æ‡’åŠ è½½
<img v-lazy="imageUrl" />

// 3. è™šæ‹Ÿæ»šåŠ¨ï¼ˆé•¿åˆ—è¡¨ä¼˜åŒ–ï¼‰
import { useVirtualList } from '@vueuse/core';

const { list, containerProps, wrapperProps } = useVirtualList(
  questions,  // 1000+é¢˜ç›®
  { itemHeight: 100 }  // æ¯é¡¹é«˜åº¦
);

// 4. é˜²æŠ–èŠ‚æµ
import { debounce } from 'lodash';

const search = debounce((keyword) => {
  // æœç´¢é€»è¾‘
}, 300);
```

### 2. åç«¯æ€§èƒ½ä¼˜åŒ–

**æŠ€æœ¯ç‚¹ï¼š**

```java
// 1. æ•°æ®åº“è¿æ¥æ± ï¼ˆHikariCPï¼‰
spring:
  datasource:
    hikari:
      maximum-pool-size: 20
      minimum-idle: 10
      connection-timeout: 30000

// 2. JPAæŸ¥è¯¢ä¼˜åŒ–
@EntityGraph(attributePaths = {"question", "user"})
List<ErrorBook> findByUser(User user);  // é¿å…N+1æŸ¥è¯¢

// 3. åˆ†é¡µæŸ¥è¯¢
Page<Question> findBySubject(
    String subject, 
    Pageable pageable  // åˆ†é¡µå‚æ•°
);

// 4. æ‰¹é‡æ“ä½œ
@Transactional
public void batchInsert(List<ErrorBook> errorBooks) {
    errorBookRepository.saveAll(errorBooks);  // æ‰¹é‡æ’å…¥
}
```

### 3. æ¶æ„ä¼˜åŒ–

**è´Ÿè½½å‡è¡¡ + åˆ†å¸ƒå¼éƒ¨ç½²**

```
              Nginx (è´Ÿè½½å‡è¡¡)
                    |
         +----------+----------+
         |          |          |
      Server1    Server2    Server3
         |          |          |
         +----------+----------+
                    |
              MySQL (ä¸»ä»å¤åˆ¶)
         Master â†’ Slave1, Slave2
```

---

## ç¬¬å…­éƒ¨åˆ†ï¼šæ€»ç»“ä¸å±•æœ›ï¼ˆ2åˆ†é’Ÿï¼‰

### æŠ€æœ¯æˆæœ

**ä»£ç é‡ï¼š**
- å‰ç«¯ï¼š8,000+ è¡Œ
- åç«¯ï¼š12,000+ è¡Œ
- é…ç½®ï¼š500+ è¡Œ
- **æ€»è®¡ï¼š20,000+ è¡Œä»£ç **

**æ€§èƒ½æŒ‡æ ‡ï¼š**
- APIå“åº”ï¼š< 100ms
- AIåˆ†æï¼š< 3s
- å¹¶å‘æ”¯æŒï¼š1000+
- ç³»ç»Ÿå¯ç”¨æ€§ï¼š99.9%

**æ ¸å¿ƒæŠ€æœ¯çªç ´ï¼š**
1. âœ… AIå¤šæ¨¡æ€åº”ç”¨ï¼ˆGLM-4Vå›¾åƒ+æ–‡æœ¬ï¼‰
2. âœ… Prompt Engineeringï¼ˆè´¨é‡æ§åˆ¶ï¼‰
3. âœ… çŸ¥è¯†å›¾è°±ç®—æ³•ï¼ˆå›¾+AIèåˆï¼‰
4. âœ… æ¨èç®—æ³•ï¼ˆå¤šå› ç´ åŠ æƒï¼‰
5. âœ… é«˜å¹¶å‘å¤„ç†ï¼ˆå¼‚æ­¥+ç¼“å­˜+ä¼˜åŒ–ï¼‰

### æŠ€æœ¯äº®ç‚¹

1. **ä¸åªæ˜¯è°ƒç”¨API**
   - APIè°ƒç”¨ä»…20%
   - æ ¸å¿ƒåœ¨äºç®—æ³•è®¾è®¡ã€æ•°æ®å¤„ç†ã€ç³»ç»Ÿæ¶æ„

2. **å·¥ç¨‹å®è·µå®Œæ•´**
   - ä»éœ€æ±‚åˆ†æåˆ°éƒ¨ç½²ä¸Šçº¿
   - åŒ…å«è´¨é‡ä¿è¯ã€æ€§èƒ½ä¼˜åŒ–ã€ç›‘æ§æ—¥å¿—

3. **æŠ€æœ¯æ ˆç°ä»£åŒ–**
   - Vue 3 + TypeScriptï¼ˆå‰ç«¯ï¼‰
   - Spring Boot 3 + Java 17ï¼ˆåç«¯ï¼‰
   - AIå¤§æ¨¡å‹æ·±åº¦é›†æˆ

### æœªæ¥ä¼˜åŒ–æ–¹å‘

**æŠ€æœ¯å±‚é¢ï¼š**
1. å¼•å…¥å‘é‡æ•°æ®åº“ï¼ˆæå‡ç›¸ä¼¼åº¦è®¡ç®—ï¼‰
2. å¾®æœåŠ¡æ‹†åˆ†ï¼ˆæå‡å¯ç»´æŠ¤æ€§ï¼‰
3. è‡ªå»ºå°å‹AIæ¨¡å‹ï¼ˆé™ä½æˆæœ¬ï¼‰
4. å®æ—¶æ¨é€ï¼ˆWebSocketï¼‰

**ç®—æ³•å±‚é¢ï¼š**
1. æ·±åº¦å­¦ä¹ æ¨èç®—æ³•
2. çŸ¥è¯†å›¾è°±æ‰©å±•ï¼ˆå…³è”æ›´å¤šæ•°æ®ï¼‰
3. è‡ªé€‚åº”å­¦ä¹ è·¯å¾„è§„åˆ’

---

## ğŸ¯ æ±‡æŠ¥æŠ€å·§

### âœ… æ—¶é—´åˆ†é…
- æ¶æ„è®¾è®¡ï¼š3åˆ†é’Ÿ
- æ ¸å¿ƒå®ç°ï¼š8åˆ†é’Ÿï¼ˆæœ€é‡è¦ï¼‰
- æŠ€æœ¯éš¾ç‚¹ï¼š4åˆ†é’Ÿ
- å…¶ä»–ï¼š5åˆ†é’Ÿ

### âœ… è®²è§£é‡ç‚¹
1. **æ¶æ„å›¾è¦æ¸…æ™°**ï¼ˆç”»åœ¨PPTä¸Šï¼‰
2. **ä»£ç è¦ç²¾é€‰**ï¼ˆå±•ç¤ºæ ¸å¿ƒé€»è¾‘ï¼‰
3. **æ•°æ®è¦çœŸå®**ï¼ˆæ€§èƒ½æŒ‡æ ‡ï¼‰
4. **éš¾ç‚¹è¦çªå‡º**ï¼ˆå±•ç¤ºè§£å†³èƒ½åŠ›ï¼‰

### âœ… å›ç­”æŠ€å·§
- ä¸çŸ¥é“å°±è¯´"è¿™æ˜¯ä¸ªå¥½é—®é¢˜ï¼Œæˆ‘ä¼šåç»­ç ”ç©¶"
- å¼ºè°ƒ"å·¥ç¨‹å®è·µ"ä¸åªæ˜¯"è°ƒç”¨API"
- çªå‡º"ç®—æ³•è®¾è®¡"å’Œ"æ€§èƒ½ä¼˜åŒ–"

---

**ç¥æ‚¨æ±‡æŠ¥æˆåŠŸï¼** ğŸ‰ğŸš€



